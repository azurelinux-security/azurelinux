From b556ef308c13004a5ff35585a092deb382d1aa55 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Mon, 30 Jun 2025 15:29:26 +0000
Subject: [PATCH] Fix CVE CVE-2025-5318 in libssh

[Backported] Upstream Patch Reference: {real_patch_url}
---
 src/sftpserver.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/sftpserver.c b/src/sftpserver.c
index 9117f15..b3349e1 100644
--- a/src/sftpserver.c
+++ b/src/sftpserver.c
@@ -538,7 +538,7 @@ void *sftp_handle(sftp_session sftp, ssh_string handle){
 
   memcpy(&val, ssh_string_data(handle), sizeof(uint32_t));
 
-  if (val > SFTP_HANDLES) {
+  if (val >= SFTP_HANDLES) {
     return NULL;
   }
 
-- 
2.45.3

