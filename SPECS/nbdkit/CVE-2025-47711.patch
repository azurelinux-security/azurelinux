From d874064d8e96946d8d9bc9d86360f342998b09b4 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Mon, 30 Jun 2025 14:34:53 +0000
Subject: [PATCH] Fix CVE CVE-2025-47711 in nbdkit

Upstream Patch Reference: {real_patch_url}
---
 server/protocol.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/protocol.c b/server/protocol.c
index d9a5e28..c32fec8 100644
--- a/server/protocol.c
+++ b/server/protocol.c
@@ -493,7 +493,7 @@ extents_to_block_descriptors (struct nbdkit_extents *extents,
       (*nr_blocks)++;
 
       pos += length;
-      if (pos > offset + count) /* this must be the last block */
+      if (pos >= offset + count) /* this must be the last block */
         break;
 
       /* If we reach here then we must have consumed this whole
-- 
2.45.3

