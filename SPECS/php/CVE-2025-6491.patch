From 6e73fd8bb70174aa694be369b299a9d4259cfc30 Mon Sep 17 00:00:00 2001
From: Azure Linux Security Servicing Account
 <azurelinux-security@microsoft.com>
Date: Mon, 14 Jul 2025 09:52:21 +0000
Subject: [PATCH] Fix CVE CVE-2025-6491 in php

Upstream Patch Reference: https://github.com/php/php-src/commit/9cb3d8d200f0c822b17bda35a2a67a97b039d3e1.patch
---
 ext/soap/soap.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/ext/soap/soap.c b/ext/soap/soap.c
index 3f8a50ba..fc51e326 100644
--- a/ext/soap/soap.c
+++ b/ext/soap/soap.c
@@ -3980,8 +3980,10 @@ static xmlNodePtr serialize_zval(zval *val, sdlParamPtr param, char *paramName,
 	}
 	xmlParam = master_to_xml(enc, val, style, parent);
 	zval_ptr_dtor(&defval);
-	if (!strcmp((char*)xmlParam->name, "BOGUS")) {
-		xmlNodeSetName(xmlParam, BAD_CAST(paramName));
+	if (xmlParam != NULL) { 
+		if (xmlParam->name == NULL || strcmp((char*)xmlParam->name, "BOGUS") == 0) {
+			xmlNodeSetName(xmlParam, BAD_CAST(paramName));
+		}
 	}
 	return xmlParam;
 }
-- 
2.45.3

